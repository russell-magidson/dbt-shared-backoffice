version: 2

sources:
  - name: bi_bo_keys
    project: | 
      {%-   if target.name == "sbx_target" -%} us-atldm-test-dev-9198
      {%- elif target.name == "dev_target" -%} us-atldm-test-dev-9198
      {%- elif target.name == "acc_target" -%} us-atldm-test-qa-2114
      {%- elif target.name == "prd_target" -%} us-atldm-test-prd-99b5
      {%- else -%} us-atldm-test-dev-9198
      {%- endif -%}
    schema: | 
      {%-   if target.name == "sbx_target" -%} sbxx_{{ env_var( 'USER') }}_data_mart_BI_BO_Keys
      {%- elif target.name == "dev_target" -%} tstt_data_mart_BI_BO_Keys
      {%- elif target.name == "acc_target" -%} accc_data_mart_BI_BO_Keys
      {%- elif target.name == "prd_target" -%} prdd_data_mart_BI_BO_Keys
      {%- else -%} sbxx_{{ env_var( 'USER') }}_data_mart_BI_BO_Keys
      {%- endif -%}
    tables:
      - name: keys_customer
        columns:
          - name: cust_key
            description: Surrogate key for dim_customer
            tests:
              - unique
      - name: keys_department
        columns:
          - name: dept_key
            description: Surrogate key for dim_department
            tests:
              - unique
      - name: keys_employee
        columns:
          - name: employee_key
            description: Surrogate key for dim_employee
            tests:
              - unique
